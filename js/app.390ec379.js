(function(){"use strict";var e={632:function(e,t,n){var l=n(963),r=n(252);function a(e,t,n,l,a,i){const o=(0,r.up)("LiftArea");return(0,r.wg)(),(0,r.j4)(o)}var i=n(637);const o=(e,t,n)=>e.reduce(((e,{isMoving:n,currentLevel:l,number:r})=>!n&&Math.abs(t-l)<e.gap?{currentLevel:l,number:r,movingTo:t,gap:Math.abs(t-l),direction:t-l<0?"down":"up"}:e),{allBusy:!0,gap:n}),s=e=>({...e,buttonSystem:e.buttonSystem.map((({level:e})=>({level:e,called:!1}))),shaftSystem:e.shaftSystem.map((e=>({...e,direction:null,gap:null,isMoving:!1,movingTo:null,pending:!1}))),levelsQueue:[]});var u=n(577);const c={class:"area-shafts"};function v(e,t,n,l,a,i){const o=(0,r.up)("LiftShaft"),s=(0,r.up)("ButtonSystem");return(0,r.wg)(),(0,r.iD)("div",{key:l.areaBackground,class:"wrapper"},[(0,r._)("div",{style:(0,u.j5)({background:l.areaBackground}),class:"area"},[(0,r._)("div",c,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.shaftSystem,((e,t)=>((0,r.wg)(),(0,r.j4)(o,{key:t,number:e.number},null,8,["number"])))),128))]),(0,r.Wm)(s)],4)])}const f={class:"btn-system"};function d(e,t,n,l,a,i){const o=(0,r.up)("LiftButton");return(0,r.wg)(),(0,r.iD)("div",f,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.buttonSystem,(e=>((0,r.wg)(),(0,r.j4)(o,{key:e.level,level:e.level},null,8,["level"])))),128))])}const m=e=>((0,r.dD)("data-v-1626485f"),e=e(),(0,r.Cn)(),e),g={class:"btn-wrap"},p=m((()=>(0,r._)("div",{class:"btn__circle"},null,-1))),S=m((()=>(0,r._)("div",{class:"btn__circuit"},null,-1))),h={class:"level"};function b(e,t,n,l,a,i){return(0,r.wg)(),(0,r.iD)("div",g,[(0,r._)("div",{class:(0,u.C_)([[e.btn,l.callButtonIsActive?"btn_active":""],"btn"]),onClick:t[0]||(t[0]=(...e)=>l.handleButtonCall&&l.handleButtonCall(...e)),type:"button"},[p,S,(0,r._)("span",h,(0,u.zw)(n.level),1)],2)])}var y=n(262),L={setup({level:e}){const{dispatch:t,getters:{watchButtonState:n,shaftSystem:l,maxLevel:a,getPendingStatus:s,levelsQueue:u}}=(0,i.oR)(),c=(0,y.iH)(!1),v=(0,y.iH)(!1),f=(0,r.Fl)((()=>c.value&&!v.value||u.includes(e)));(0,r.YP)((()=>s(e)),(e=>v.value=e)),(0,r.YP)((()=>n(e)),(()=>c.value=!Boolean(c.value)));const d=()=>{const n=o(l,e,a);n.allBusy||c.value?n.allBusy&&!c.value&&t("addToQueue",e):t("registerCall",n)};return{callButtonIsActive:f,handleButtonCall:d}},props:["level"]},w=n(744);const T=(0,w.Z)(L,[["render",b],["__scopeId","data-v-1626485f"]]);var B=T,_={setup(){const{getters:{buttonSystem:e}}=(0,i.oR)();return{buttonSystem:e}},components:{LiftButton:B}};const C=(0,w.Z)(_,[["render",d],["__scopeId","data-v-0fe5e0b6"]]);var x=C;function I(e,t,n,l,a,i){const o=(0,r.up)("Lift");return(0,r.wg)(),(0,r.iD)("div",{style:(0,u.j5)({width:l.levelSize}),class:"shaft"},[(0,r.Wm)(o,{number:n.number},null,8,["number"])],4)}function Q(e,t,n,a,i,o){const s=(0,r.up)("LiftIndicator");return(0,r.wg)(),(0,r.iD)("div",{ref:"liftRef",style:(0,u.j5)({height:a.levelSize,transform:a.liftTranslate,transition:a.liftTransition}),class:"lift"},[(0,r.wy)((0,r.Wm)(s,{lift:a.lift},null,8,["lift"]),[[l.F8,a.indicatorIsVisible]])],4)}const k={class:"indicator"},j={class:"indicator-to"};function O(e,t,n,l,a,i){const o=(0,r.up)("LiftArrow");return(0,r.wg)(),(0,r.iD)("div",k,[(0,r.Wm)(o,{lift:n.lift},null,8,["lift"]),(0,r._)("div",j,(0,u.zw)(l.movingTo),1)])}const M={class:"wrap"};function A(e,t,n,l,a,i){return(0,r.wg)(),(0,r.iD)("div",M,[(0,r._)("div",{class:(0,u.C_)(["arrow",l.direction])},null,2)])}var P={setup({lift:e}){const t=(0,r.Fl)((()=>e.value&&e.value.direction));return{direction:t}},props:["lift"]};const z=(0,w.Z)(P,[["render",A],["__scopeId","data-v-58236d52"]]);var D=z,F={setup({lift:e}){const t=(0,r.Fl)((()=>e.value&&e.value.movingTo));return{movingTo:t}},props:["lift"],components:{LiftArrow:D}};const R=(0,w.Z)(F,[["render",O],["__scopeId","data-v-656b652c"]]);var H=R,Z={setup({number:e}){const{dispatch:t,getters:{levelSize:n,shaftSystem:l,maxLevel:a,getLift:s,watchLiftMoving:u,levelsQueue:c}}=(0,i.oR)(),v=(0,y.qj)(s(e)),f=(0,r.Fl)((()=>v.value&&v.value.direction)),d=(0,y.iH)(null),m=(0,y.iH)(`translateY(-${v.currentLevel-1}00%)`),g=(0,y.iH)(""),p=(t="queue")=>{if(v.value=s(e),t){const e=m.value.match(/\-?\d+/)[0]||0,{gap:t,movingTo:n,currentLevel:l}=v.value,r=+e+100*(l-n);g.value=`transform ${t}s linear`,m.value=`translateY(${r}%)`}};return(0,r.bv)((()=>{d.value.addEventListener("transitionend",(e=>{d.value.classList.add("wait"),t("setPendingStatusToLift",v.value)})),d.value.addEventListener("animationend",(n=>{if(d.value.classList.remove("wait"),t("unregisterCall",v.value),v.value=s(e),c.length){const e=o(l,c[0],a);v.value=e,t("registerCall",v.value),p(),t("removeFromQueue")}}))})),(0,r.YP)((()=>u(e)),(e=>{p(e)})),{levelSize:n+"px",liftTranslate:m,liftTransition:g,liftRef:d,lift:v,indicatorIsVisible:f}},components:{LiftIndicator:H},props:["number"]};const Y=(0,w.Z)(Z,[["render",Q],["__scopeId","data-v-36fe35e2"]]);var E=Y,W={setup(){const{getters:{levelSize:e}}=(0,i.oR)();return{levelSize:e+"px"}},components:{Lift:E},props:["number"]};const $=(0,w.Z)(W,[["render",I],["__scopeId","data-v-5cec1f03"]]);var q=$,J={setup(){const{dispatch:e,getters:t}=(0,i.oR)();if(localStorage&&localStorage.state){const t=JSON.parse(localStorage.state);e("insertLocalStorageState",t)}else e("initSystem");return{areaBackground:t.areaBackground,shaftSystem:t.shaftSystem}},methods:{reRender(){this.$forceUpdate()}},components:{ButtonSystem:x,LiftButton:B,LiftShaft:q}};const K=(0,w.Z)(J,[["render",v]]);var N=K,V={name:"App",setup(){const e=(0,i.oR)(),t=(e,t)=>"value"==e?void 0:t;window.addEventListener("beforeunload",(function(n){if(localStorage){const n=JSON.stringify(s(e.state),t);localStorage.setItem("state",n)}}))},components:{LiftArea:N}};const U=(0,w.Z)(V,[["render",a]]);var G=U;const X={initSystem({commit:e}){e("initShaftSystem"),e("initButtonSystem")},insertLocalStorageState({commit:e},t){e("insertLocalStorageState",t)},registerCall({commit:e},t){0!==t.gap&&(e("registerButtonCall",t),e("registerShaftCall",t))},unregisterCall({commit:e},t){e("unregisterButtonCall",t),e("unregisterShaftCall",t)},setPendingStatusToLift({commit:e},t){e("setPendingStatusToLift",t)},addToQueue({commit:e},t){e("addToQueue",t)},removeFromQueue({commit:e}){e("removeFromQueue")}},ee={levelsAmount:({levels:e})=>e,shaftsAmount:({shafts:e})=>e,buttonSystem:({buttonSystem:e})=>e,getState:e=>e,shaftSystem:({shaftSystem:e})=>e,levelsQueue:({levelsQueue:e})=>e,getLift:({shaftSystem:e})=>t=>e.find((e=>e.number===t)),getPendingStatus:({shaftSystem:e})=>t=>{const n=e.find((e=>e.movingTo===t));return!!n&&n.pending},watchLiftMoving:(e,{getLift:t})=>e=>t(e).isMoving,getCallButton:({buttonSystem:e})=>t=>e.find((e=>e.level===t)),watchButtonState:(e,{getCallButton:t})=>e=>t(e).called,levelSize:({levels:e})=>{const t=window.innerHeight-16,n=t/e;return n},areaBackground:(e,{levelSize:t})=>{const n="#e9f7ec",l="#fcfffe";return"repeating-linear-gradient("+n+", "+n+" "+t+"px, "+l+" "+t+"px, "+l+" "+2*t+"px)"},maxLevel:({buttonSystem:e})=>Math.max(...e.map((({level:e})=>e)))},te={initShaftSystem(e){e.shaftSystem=Array(e.shafts).fill().map(((e,t)=>({currentLevel:1,isMoving:!1,movingTo:null,pending:!1,gap:null,direction:null,number:t+1})))},insertLocalStorageState(e,t){Object.assign(e,t)},setPendingStatusToLift({shaftSystem:e},t){const n=e.findIndex((({number:e})=>e===t.number));e[n]={...e[n],pending:!0,currentLevel:t.movingTo}},initButtonSystem(e){e.buttonSystem=Array(e.levels).fill().map(((e,t)=>({level:t+1,called:!1}))).reverse()},registerShaftCall({shaftSystem:e},{number:t,currentLevel:n,gap:l,movingTo:r}){const a=e.findIndex((e=>e.number===t));e[a]={number:t,currentLevel:n,gap:l,movingTo:r,direction:r-n>0?"up":"down",isMoving:!0,pending:!1}},registerButtonCall({buttonSystem:e},{movingTo:t,number:n}){const l=e.findIndex((({level:e})=>e===t));e[l].called||(e[l].called=!0)},unregisterButtonCall({buttonSystem:e},{movingTo:t}){const n=e.findIndex((({level:e})=>e===t));e[n].called=!1},unregisterShaftCall({shaftSystem:e},{number:t,movingTo:n}){const l=e.findIndex((e=>e.number===t));e[l]={number:t,currentLevel:n,gap:null,movingTo:null,direction:null,isMoving:!1,pending:!1}},addToQueue({levelsQueue:e},t){e.includes(t)||e.push(t)},removeFromQueue({levelsQueue:e}){e.shift()}},ne={shafts:4,levels:17,shaftSystem:[],buttonSystem:[],levelsQueue:[]};var le=(0,i.MT)({state:ne,getters:ee,actions:X,mutations:te});(0,l.ri)(G).use(le).mount("#app")}},t={};function n(l){var r=t[l];if(void 0!==r)return r.exports;var a=t[l]={exports:{}};return e[l](a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,l,r,a){if(!l){var i=1/0;for(c=0;c<e.length;c++){l=e[c][0],r=e[c][1],a=e[c][2];for(var o=!0,s=0;s<l.length;s++)(!1&a||i>=a)&&Object.keys(n.O).every((function(e){return n.O[e](l[s])}))?l.splice(s--,1):(o=!1,a<i&&(i=a));if(o){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[l,r,a]}}(),function(){n.d=function(e,t){for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,l){var r,a,i=l[0],o=l[1],s=l[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(s)var c=s(n)}for(t&&t(l);u<i.length;u++)a=i[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(c)},l=self["webpackChunklift"]=self["webpackChunklift"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=n.O(void 0,[998],(function(){return n(632)}));l=n.O(l)})();
//# sourceMappingURL=app.390ec379.js.map